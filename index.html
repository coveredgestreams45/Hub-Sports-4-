<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CricxCrate ‚Äì Hub Sports 4</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.6.3/shaka-player.compiled.js"></script>

<style>
*{box-sizing:border-box}
body{margin:0;font-family:Roboto,sans-serif;background:#eef2f7;color:#111827}
.main{max-width:420px;margin:0 auto;padding:14px}
.card{background:#fff;border-radius:22px;padding:16px;margin-bottom:16px;box-shadow:0 10px 25px rgba(0,0,0,.08)}
.header{text-align:center;font-weight:700;font-size:18px;color:#ff6b6b}
.player-card{padding:0;overflow:hidden;background:#000;border-radius:22px;position:relative;border:2px solid #fff}
.player-wrap{position:relative;aspect-ratio:16/9;background:#000}
video{width:100%;height:100%;display:block;outline:none}

/* Overlays */
#play-overlay, #loading-overlay {
  position: absolute; inset: 0; background: rgba(0,0,0,0.85);
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  z-index: 10; cursor: pointer; color: #fff; text-align: center;
}
#loading-overlay { display: none; pointer-events: none; }
.spinner {
  width: 40px; height: 40px; border: 4px solid #f3f3f3;
  border-top: 4px solid #ff6b6b; border-radius: 50%;
  animation: spin 1s linear infinite; margin-bottom: 10px;
}
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

.section-title{text-align:center;font-weight:600;margin-bottom:12px; font-size: 14px}
.btn-row{display:flex;gap:12px;justify-content:center}
.btn{flex:1;padding:12px;border-radius:16px;font-weight:600;border:none;cursor:pointer;text-decoration:none;text-align:center;font-size:14px; transition: 0.2s}
.btn:active { transform: scale(0.95); opacity: 0.9; }
.btn.primary{background:#ff6b6b;color:#fff}
.btn.secondary{background:#fff;color:#ff6b6b;border:1px solid #ffd1d1}

.tg-banner{display:flex;align-items:center;justify-content:center;gap:10px;font-weight:600;text-decoration:none;color:inherit}
#toast{visibility:hidden;min-width:200px;background:#333;color:#fff;text-align:center;border-radius:50px;padding:12px;position:fixed;left:50%;bottom:30px;transform:translateX(-50%); z-index: 100}
#toast.show{visibility:visible}
</style>
</head>

<body>

<div id="toast">Link copied! üèè</div>

<div class="main">
  <div class="card header">CricxCrate ‚Ä¢ Hub Sports 4</div>

  <div class="card player-card">
    <div id="loading-overlay"><div class="spinner"></div>Connecting to Hub Sports 4...</div>
    <div id="play-overlay" onclick="startVideo()">
        <div style="font-size:50px; margin-bottom:10px;">‚ñ∂</div>
        <div>TAP TO WATCH HUB SPORTS 4 LIVE</div>
    </div>
    <div class="player-wrap">
      <video id="video" controls playsinline></video>
    </div>
  </div>

  <div class="card">
    <div class="section-title">‚ö°Ô∏è Join Telegram For Live Updates</div>
    <div class="btn-row">
      <a class="btn primary" href="https://t.me/CricxCrate" target="_blank">Join Telegram</a>
      <a class="btn secondary" href="https://t.me/CricxCratelinks" target="_blank">All Channels</a>
    </div>
  </div>

  <div class="card">
    <div class="section-title">‚ù§Ô∏è Share & Support</div>
    <div class="btn-row">
      <button class="btn primary" onclick="sharePage()">Share</button>
      <button class="btn secondary" onclick="copyLink()">Copy Link</button>
    </div>
  </div>

  <a href="https://t.me/CricxCrate" target="_blank" class="card tg-banner">
    <img src="https://telegram.org/img/t_logo.png" width="28">
    Join @CricxCrate
  </a>
</div>

<script>
let player;
let video;

async function initPlayer() {
  video = document.getElementById('video');
  shaka.polyfill.installAll(); 

  player = new shaka.Player(video);

  // CONFIGURE HUB SPORTS 4 CLEARKEY DRM
  player.configure({
    drm: {
      clearKeys: {
        "9a29d4f3b6e540b3aa2f36927c01b6f4": "57b670b45b5cb453a9f48fa975b702c1"
      }
    },
    streaming: {
      jumpLargeGaps: true,
      lowLatencyMode: true
    }
  });

  player.addEventListener('error', (e) => {
    console.error('Error Code:', e.detail.code);
    if(e.detail.code === 4001) showToast("Stream blocked or token expired");
  });
}

async function startVideo() {
  const playOverlay = document.getElementById('play-overlay');
  const loadingOverlay = document.getElementById('loading-overlay');
  
  playOverlay.style.display = 'none';
  loadingOverlay.style.display = 'flex';

  try {
    // NEW HUB SPORTS 4 MPD URL
    await player.load("https://bks03.starhubgo.com/bpk-token/1aa@3k4jsfemzhjwq2ildmpcm2telyxspsmb3ksb3tda/bpk-tv/HubSports4HDnew/output/manifest.mpd");
    await video.play();
    loadingOverlay.style.display = 'none';
  } catch (e) {
    loadingOverlay.style.display = 'none';
    playOverlay.style.display = 'flex';
    showToast("Connection Failed - Check Token");
  }
}

function showToast(msg) {
  const x = document.getElementById("toast");
  x.innerText = msg; x.className = "show";
  setTimeout(() => { x.className = ""; }, 3000);
}

function copyLink() {
  navigator.clipboard.writeText(window.location.href);
  showToast("Link Copied! üèè");
}

async function sharePage() {
  if (navigator.share) {
    navigator.share({ title: 'Watch Hub Sports 4 Live on CricxCrate', url: window.location.href });
  } else { copyLink(); }
}

document.addEventListener('DOMContentLoaded', initPlayer);
</script>
</body>
</html>
